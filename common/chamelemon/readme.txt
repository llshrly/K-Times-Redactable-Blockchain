Based on  https://github.com/julwil/chameleon_hash.git